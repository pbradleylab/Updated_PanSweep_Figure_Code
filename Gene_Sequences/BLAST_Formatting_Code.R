#Formatting for BLAST analysis
library(tidyverse)
library(readr)
#################################
#Paths
UHGP_90_Path <- "~/Documents/Bradley_Lab/MIDAS_Analysis_Main_Folder/PanSweep_Updated_Data_Analysis/Updated_PanSweep_Figure_Code/uhgp_90_eggNOG.tsv"

##################################

uhgp_90_eggNOG <- read_tsv(file = UHGP_90_Path)

Gene_ID <- uhgp_90_eggNOG$Gene_id

Cln_1 <- paste0("-e \"", gsub("^UHGG","",Gene_ID), "\"")

Cln_2 <- paste(Cln_1, collapse = " ")

cat(Cln_2)
#-e "064037_00369" -e "047117_02378" -e "154988_02076" -e "016431_01839" -e "200056_01835" -e "108644_01598" -e "047117_02380" -e "032492_02428" -e "047117_02376" -e "047117_02377" -e "200056_01834" -e "041746_02389" -e "200056_01833" -e "000216_02074" -e "055467_01854" -e "047117_02382" -e "239171_01612" -e "188302_00118" -e "151972_01002" -e "001288_02675" -e "063307_00097" -e "200056_01832" -e "047117_02379" -e "195023_01285" -e "155662_03633" -e "155662_03778" -e "210793_02030" -e "041746_02390" -e "029873_02068" -e "210928_01151" -e "064838_00419"

################################
#Format genes for Gene_Genome_Extract.sh
sep_g <- function(g){
  G1 <- paste0("\"", gsub("^UHGG","", g), "\"")
  G2 <- paste(G1, collaple= " ")
}

sep_genes <- uhgp_90_eggNOG %>%
  group_by(Species_id) %>%
  summarise(grp_sp = sep_g(Gene_id) )

unique(sep_genes$Species_id)
#[1] "100060" "100078" "100271" "102528"

G_100060 <- sep_genes %>% filter(Species_id == "100060") %>% pull(grp_sp)
G_100078 <- sep_genes %>% filter(Species_id == "100078") %>% pull(grp_sp)
G_100271 <- sep_genes %>% filter(Species_id == "100271") %>% pull(grp_sp)
G_102528 <- sep_genes %>% filter(Species_id == "102528") %>% pull(grp_sp)

cat(G_100060)
#"047117_02378"   "047117_02380"   "047117_02376"   "047117_02377"   "041746_02389"   "000216_02074"   "055467_01854"   "047117_02382"   "239171_01612"   "001288_02675"   "063307_00097"   "047117_02379"   "210793_02030"   "041746_02390"   "029873_02068"   "210928_01151"  
cat(G_100078)
#"064037_00369"   "154988_02076"   "016431_01839"   "108644_01598"   "188302_00118"   "151972_01002"   "195023_01285" 
cat(G_100271)
#"200056_01835"   "032492_02428"   "200056_01834"   "200056_01833"   "200056_01832"   "155662_03633"   "155662_03778"
cat(G_102528)
#"064838_00419"
###############################
#Prepare genes for Gene_Sequence_Obtaining_Code.sh
GS1_100060 <- paste0("/", G_100060, "/,/p;") 
GS_100060 <- paste(GS1_100060, collapse = " ")
cat(GS_100060)
#/"047117_02378"  /,/p; /"047117_02380"  /,/p; /"047117_02376"  /,/p; /"047117_02377"  /,/p; /"041746_02389"  /,/p; /"000216_02074"  /,/p; /"055467_01854"  /,/p; /"047117_02382"  /,/p; /"239171_01612"  /,/p; /"001288_02675"  /,/p; /"063307_00097"  /,/p; /"047117_02379"  /,/p; /"210793_02030"  /,/p; /"041746_02390"  /,/p; /"029873_02068"  /,/p; /"210928_01151"  /,/p;

GS1_100078 <- paste0("/", G_100078, "/,/p;") 
GS_100078 <- paste(GS1_100078, collapse = " ")
cat(GS_100078)
#/"064037_00369"  /,/p; /"154988_02076"  /,/p; /"016431_01839"  /,/p; /"108644_01598"  /,/p; /"188302_00118"  /,/p; /"151972_01002"  /,/p; /"195023_01285"  /,/p;

GS1_100271 <- paste0("/", G_100271, "/,/p;") 
GS_100271 <- paste(GS1_100271, collapse = " ")
cat(GS_100271)
#/"200056_01835"  /,/p; /"032492_02428"  /,/p; /"200056_01834"  /,/p; /"200056_01833"  /,/p; /"200056_01832"  /,/p; /"155662_03633"  /,/p; /"155662_03778"  /,/p;

GS1_102528 <- paste0("/", G_102528, "/,/p;") 
GS_102528 <- paste(GS1_102528, collapse = " ")
cat(GS_102528)
#/"064838_00419"  /,/p;