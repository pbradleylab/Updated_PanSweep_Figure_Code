#Formatting for BLAST analysis
library(tidyverse)
library(readr)
#################################
#Paths
UHGP_90_Path <- "~/Documents/Bradley_Lab/MIDAS_Analysis_Main_Folder/PanSweep_Updated_Data_Analysis/Updated_PanSweep_Figure_Code/uhgp_90_eggNOG.tsv"
Path_UHGP_100_trans <- "~/Documents/Bradley_Lab/MIDAS_Analysis_Main_Folder/PanSweep_Updated_Data_Analysis/Updated_PanSweep_Figure_Code/Gene_Sequences/Uhgp_100_to_Gene_Numbers.tsv"
##################################

uhgp_90_eggNOG <- read_tsv(file = UHGP_90_Path)

Gene_ID <- uhgp_90_eggNOG$Gene_id

Cln_1 <- paste0("-e \"", gsub("^UHGG","",Gene_ID), "\"")

Cln_2 <- paste(Cln_1, collapse = " ")

cat(Cln_2)
# -e "200056_01835" -e "108644_01598" -e "064037_00369" -e "047117_02378" -e "154988_02076" -e "016431_01839" -e "228006_01743" -e "047117_02380" -e "148794_01632" -e "032492_02428" -e "047117_02376" -e "041746_02389" -e "047117_02377" -e "200056_01833" -e "200056_01834" -e "192308_01194" -e "000216_02074" -e "152466_01649" -e "055467_01854" -e "047117_02383" -e "063379_01966" -e "047117_02382" -e "181581_00481" -e "188302_00118" -e "032185_00468" -e "151972_01002" -e "041746_02388" -e "063307_00097" -e "200056_01832" -e "047117_02379" -e "195023_01285" -e "155662_03633" -e "155662_03778" -e "210793_02030" -e "041746_02390" -e "047117_02375" -e "047117_02381" -e "258864_02598" -e "029873_02068" -e "210928_01151" -e "064838_00419"
################################
#Format genes for Gene_Genome_Extract.sh
sep_g <- function(g){
  G1 <- paste0("\"", gsub("^UHGG","", g), "\"")
  G2 <- paste(G1, collaple= " ")
}

sep_genes <- uhgp_90_eggNOG %>%
  group_by(Species_id) %>%
  summarise(grp_sp = sep_g(Gene_id) )

unique(sep_genes$Species_id)
#[1] "100060" "100078" "100271" "102528"

G_100060 <- sep_genes %>% filter(Species_id == "100060") %>% pull(grp_sp)
G_100078 <- sep_genes %>% filter(Species_id == "100078") %>% pull(grp_sp)
G_100271 <- sep_genes %>% filter(Species_id == "100271") %>% pull(grp_sp)
G_102528 <- sep_genes %>% filter(Species_id == "102528") %>% pull(grp_sp)

cat(G_100060)
#"047117_02378"   "228006_01743"   "047117_02380"   "148794_01632"   "047117_02376"   "041746_02389"   "047117_02377"   "192308_01194"   "000216_02074"   "152466_01649"   "055467_01854"   "047117_02383"   "047117_02382"   "181581_00481"   "032185_00468"   "041746_02388"   "063307_00097"   "047117_02379"   "210793_02030"   "041746_02390"   "047117_02375"   "047117_02381"   "258864_02598"   "029873_02068"   "210928_01151" 
cat(G_100078)
#"108644_01598"   "064037_00369"   "154988_02076"   "016431_01839"   "063379_01966"   "188302_00118"   "151972_01002"   "195023_01285"  
cat(G_100271)
#"200056_01835"   "032492_02428"   "200056_01833"   "200056_01834"   "200056_01832"   "155662_03633"   "155662_03778"
cat(G_102528)
#"064838_00419" 

##################################
#Follow up
UHGP_100 <- read_tsv(file = Path_UHGP_100_trans, col_names = FALSE)
#Super long b/c GUT_GENOME016431_01839 represents alot of genes
#Just need to use unique on X1
UHGP_100_cID <- unique(UHGP_100$X1) 

sep_gg <- function(g){
  G1 <- paste0("-e \"", gsub("^GUT_GENOME","", g), "\"")
  G2 <- paste(G1, collaple= " ")
}

UHGP_100_cln <- UHGP_100_cID %>% sep_gg()

cat(UHGP_100_cln)
#-e "041746_02389"   -e "156581_00568"   -e "246241_00488"   -e "200056_01834"   -e "186001_01421"   -e "016431_01839"   -e "149870_00780"   -e "210811_00453"   -e "181581_00481"   -e "210531_01353"   -e "258864_02598"   -e "200056_01833"   -e "041746_02388"   -e "151055_01601"   -e "055467_01854"   -e "004689_00515"   -e "058324_00427"   -e "030231_00195"   -e "152024_01664"   -e "063154_01644"   -e "060538_00391"   -e "017453_01069"   -e "000216_02074"   -e "155662_03633"   -e "099736_00986"   -e "007643_02005"   -e "017126_00406"   -e "192308_01194"   -e "010616_00971"   -e "154577_00206"   -e "063941_02093"   -e "029873_02068"   -e "210928_01151"   -e "063495_00342"   -e "200056_01835"   -e "064838_00419"   -e "047117_02377"   -e "047117_02380"   -e "032185_00468"   -e "108644_01598"   -e "176730_00858"

